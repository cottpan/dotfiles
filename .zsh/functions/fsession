#!/usr/bin/env zsh
#
# fsession - Tmux Session Switcher with fzf
#
# Description:
#   tmux セッションを fzf で選択して切り替え／アタッチ
#   tmux 内からの実行 → switch-client（セッション切り替え）
#   tmux 外からの実行 → attach-session（セッションにアタッチ）
#
# Usage:
#   fsession [query]
#
# Example:
#   fsession          # 全セッションから選択
#   fsession work     # "work" で絞り込んで選択
#
fsession() {
  local session
  session=$(tmux list-sessions -F "#{session_name}" 2>/dev/null | \
    fzf --query="$1" --select-1 --exit-0) || return
  
  if [ -n "$TMUX" ]; then
    # tmux セッション内にいる場合は switch-client を使用
    tmux switch-client -t "$session"
  else
    # tmux セッション外にいる場合は attach-session を使用
    tmux attach-session -t "$session"
  fi
}
